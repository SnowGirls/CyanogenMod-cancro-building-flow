

************ set sdk & ndk path ************

local.properties

sdk.dir=~/Workspaces/AndroidSDK
ndk.dir=~/Workspaces/AndroidSDK/ndk/17.2.4988734


************ Gradle build only one module ************

# https://proandroiddev.com/tip-work-with-third-party-projects-locally-with-gradle-961d6c9efb02
# https://stackoverflow.com/a/16987319/1749293

./gradlew app:build  # ./gradlew :app:build  ‰πüË°å 

./gradlew app:dependencies  # Êü•ÁúãAppÊâÄÊúâ‰æùËµñÊ†ë


./gradlew tasks --all | less   # Êü•ÁúãÊâÄÊúâ task, or just `./gradlew tasks --all > ~/Downloads/gradlew_tasks-all.txt`




************ Ê∫êÁ†ÅÊñπÂºè ËÆ©Â≠ê project Êü•Êâæ project ************

settings.gradle
// :vision-camera ‰∏çÊâìÂåÖ aar ‰∫ÜÁî®Ê∫êÁ†Å‰æùËµñÁöÑÊñπÂºè
include ':vision-camera'
rootProject.children.each { proj ->
    if (proj.name == "flutter_vision_camera") {
        println "üçÄüçÄüçÄ Making source dependency(NOT .AAR) for project :vision-camera on path: ${proj.projectDir}/../../android/vision-camera\n"
        project(':vision-camera').projectDir = new File(proj.projectDir, '../../android/vision-camera')
    }
}



************ ÊúÄÊñ∞ÁöÑ publishToMavenLocal on build.gradle ************

apply plugin: 'maven-publish'

afterEvaluate {
    publishing {
        publications {
            mavenJava(MavenPublication) {
                from components.release
                groupId = "com.xiaopeng.xiaolong.react-native"
                artifactId = "rn-gallery-saver"
                version = "1.0.0-SNAPSHOT"
            }
        }
        // Âè™ÂèëÂ∏ÉÂà∞Êú¨Âú∞ÁöÑÂèØ‰ª•‰∏çÂÜô‰∏ãÈù¢ÊåáÂÆöÊåáÂÆö‰ªìÂ∫ìÂú∞ÂùÄ‰∫Ü
        repositories {
            mavenLocal()
        }
    }
}



************ ÊâìÂç∞È°πÁõÆÈáåÁöÑÊâÄÊúâÂ±ûÊÄß ************
// ÊâìÂç∞‰∏Ä‰∏ãÊâÄÊúâÁöÑÂÖ®Â±ÄÂèòÈáè‰∏éProjectÂ±ûÊÄßÔºå‰æø‰∫éË∞ÉËØï
println "================ Project Properties ================"
project.properties.each { prop ->
     println "${prop.key} = ${prop.value}"
    // Â¶ÇÊûú key ‰∏∫ flutter ÁöÑËØùÔºåÂèØ‰ª•ÊâìÂç∞Êõ¥Â§ö‰ø°ÊÅØ
    if (prop.key == 'flutter') {
        // ÊâìÂç∞ flutter ÊâÄÊúâÂ±ûÊÄß
        flutter.properties.each { fProp ->
            println "    ${fProp.key} = ${fProp.value}"
        }
    }
}



plugins.withId("com.android.library") {
    val libExt = extensions.getByType<LibraryExtension>()
    if (libExt.namespace == null || libExt.namespace!!.isBlank()) {
        val manifestFile = file("${projectDir}/src/main/AndroidManifest.xml")
        if (manifestFile.exists()) {
            val manifestContent = manifestFile.readText()
            val packageName = Regex("""package\s*=\s*["']([^"']+)["']""")
                .find(manifestContent)
                ?.groupValues?.getOrNull(1)
            if (!packageName.isNullOrBlank()) {
                println("‚úì ‰∏∫Êèí‰ª∂ ${project.name} Ê≥®ÂÖ• namespace: $packageName")
                libExt.namespace = packageName
            }
        }
    }
}

